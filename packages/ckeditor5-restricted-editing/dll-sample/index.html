<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>DLL sample - Restricted Editing</title>
</head>
<body>

<p>
	<b>Mode</b>:
	<input type="radio" id="mode-standard" name="mode" value="standard" checked><label for="mode-standard">Standard</label>
	<input type="radio" id="mode-restricted" name="mode" value="restricted"><label for="mode-restricted">Restricted</label>
</p>

<div id="editor">
	<h2>Heading 1</h2>
	<p>Paragraph <span class="restricted-editing-exception">it is editable</span></p>
	<p>Exception on part of a word: <a href="ckeditor.com">coompi</a><span class="restricted-editing-exception"><a
		href="ckeditor.com">ter</a> (fix spelling in Firefox).</span></p>
	<p><strong>Bold</strong> <i>Italic</i> <a href="foo">Link</a></p>
	<figure class="table">
		<table>
			<tbody>
				<tr>
					<td><span class="restricted-editing-exception">foo bar</span></td>
				</tr>
			</tbody>
		</table>
	</figure>
	<ul>
		<li>UL List item 1</li>
		<li>UL List item 2</li>
	</ul>
	<ol>
		<li><span class="restricted-editing-exception">OL List item 1</span></li>
		<li>OL List item 2</li>
	</ol>
	<figure class="image image-style-side">
		<img alt="bar" src="sample.jpg">
		<figcaption>Caption</figcaption>
	</figure>
	<blockquote>
		<p>Quote</p>
		<ul>
			<li>Quoted UL List item 1</li>
			<li>Quoted UL List item <span class="restricted-editing-exception">2</span></li>
		</ul>
		<p>Quote</p>
	</blockquote>
</div>

<script src="https://unpkg.com/@ckeditor/ckeditor5-inspector/build/inspector.js"></script>

<!-- This adds the CKEditor5.dll() in the global scope, so it is possible to reference its contents -->
<script src="./../../../node_modules/ckeditor5/build/ckeditor5-dll.js"></script>

<!-- Those are stripped-down editors with Essentials plugins loaded from a DLL, exposed on CKEditor global -->
<script src="./../../../node_modules/@ckeditor/ckeditor5-dll-classic/build/dll-classic.js"></script>

<!-- Editor features as DLL consumer builds exposed as CKEditor5[featureName] -->
<script src="./../../../node_modules/@ckeditor/ckeditor5-adapter-ckfinder/build/adapter-ckfinder.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-alignment/build/alignment.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-autoformat/build/autoformat.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-autosave/build/autosave.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-basic-styles/build/basic-styles.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-block-quote/build/block-quote.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-ckfinder/build/ckfinder.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-cloud-services/build/cloud-services.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-code-block/build/code-block.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-easy-image/build/easy-image.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-editor-balloon/build/editor-balloon.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-editor-classic/build/editor-classic.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-editor-decoupled/build/editor-decoupled.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-editor-inline/build/editor-inline.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-font/build/font.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-heading/build/heading.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-highlight/build/highlight.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-horizontal-line/build/horizontal-line.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-html-embed/build/html-embed.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-image/build/image.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-indent/build/indent.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-link/build/link.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-list/build/list.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-markdown-gfm/build/markdown-gfm.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-media-embed/build/media-embed.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-mention/build/mention.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-page-break/build/page-break.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-paste-from-office/build/paste-from-office.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-remove-format/build/remove-format.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-restricted-editing/build/restricted-editing.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-special-characters/build/special-characters.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-table/build/table.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-watchdog/build/watchdog.js"></script>
<script src="./../../../node_modules/@ckeditor/ckeditor5-word-count/build/word-count.js"></script>

<script>
	const {
		ClassicEditor,
		blockQuote,
		codeBlock,
		basicStyles,
		heading,
		htmlEmbed,
		image,
		indent,
		link,
		list,
		mediaEmbed,
		table,
		restrictedEditing
	} = CKEditor5;

	const restrictedModeButton = document.getElementById( 'mode-restricted' );
	const standardModeButton = document.getElementById( 'mode-standard' );

	restrictedModeButton.addEventListener( 'change', handleModeChange );
	standardModeButton.addEventListener( 'change', handleModeChange );

	startMode( document.querySelector( 'input[name="mode"]:checked' ).value );

	async function handleModeChange( evt ) {
		await startMode( evt.target.value );
	}

	async function startMode( selectedMode ) {
		if ( selectedMode === 'standard' ) {
			await startStandardEditingMode();
		} else {
			await startRestrictedEditingMode();
		}
	}

	async function startStandardEditingMode() {
		await reloadEditor( {
			plugins: [
				blockQuote.BlockQuote,
				codeBlock.CodeBlock,
				heading.Heading,
				basicStyles.Bold,
				basicStyles.Italic,
				basicStyles.Code,
				list.List,
				link.Link,
				image.Image,
				image.ImageCaption,
				image.ImageStyle,
				image.ImageToolbar,
				mediaEmbed.MediaEmbed,
				table.Table,
				restrictedEditing.StandardEditingMode
			],
			toolbar: [
				'heading', '|', 'bold', 'italic', 'link', '|',
				'bulletedList', 'numberedList', 'blockQuote', 'insertTable', '|',
				'restrictedEditingException', '|', 'undo', 'redo'
			],
			image: {
				toolbar: [ 'imageStyle:full', 'imageStyle:side', '|', 'imageTextAlternative' ]
			},
			table: {
				contentToolbar: [
					'tableColumn',
					'tableRow',
					'mergeTableCells'
				]
			}
		} );
	}

	function MyPlugin( editor ) {
		// This action must be done in the `afterInit()` method of your plugin.
		this.afterInit = () => {
			const restrictedEditingModeEditing = editor.plugins.get( 'RestrictedEditingModeEditing' );

			const commandsToEnable = [
				'insertTableRowAbove', 'insertTableRowBelow',
				'insertTableColumnRight', 'insertTableColumnLeft',
				'mergeTableCells'
			];

			// Enable (always) some commands in restricted editing mode.
			commandsToEnable.forEach( commandName => restrictedEditingModeEditing.enableCommand( commandName ) );
		};
	}

	async function startRestrictedEditingMode() {
		await reloadEditor( {
			plugins: [
				blockQuote.BlockQuote,
				codeBlock.CodeBlock,
				heading.Heading,
				basicStyles.Bold,
				basicStyles.Italic,
				basicStyles.Code,
				list.List,
				link.Link,
				image.Image,
				image.ImageCaption,
				image.ImageStyle,
				image.ImageToolbar,
				mediaEmbed.MediaEmbed,
				table.Table,
				table.TableToolbar,
				restrictedEditing.RestrictedEditingMode,
				MyPlugin
			],
			toolbar: [ 'bold', 'italic', 'link', '|', 'restrictedEditing', '|', 'undo', 'redo' ],
			table: {
				contentToolbar: [ 'tableColumn', 'tableRow', 'mergeTableCells' ],
				tableToolbar: [ 'bold', 'italic' ]
			}
		} );
	}

	async function reloadEditor( config ) {
		if ( window.editor && window.editor.destroy ) {
			await window.editor.destroy();
		}

		window.editor = await ClassicEditor.create( document.querySelector( '#editor' ), config );

		CKEditorInspector.attach( editor );
	}
</script>
</body>
</html>
